"# influx_demo"

目标

- 监控系统指标库 telegraf

- 监控应用指标库 gr_app

- 监控业务指标 gr_biz

TICK解决方案分析

- 不支持更新与删除，业务方如果插入重复数据会对统计结果造成影响，解决方式：业务方禁止发送事件重复数据，或者多次发送保证 time,tags是一致的。

这种情况下，influx会覆盖上一次的插入结果。- 注意

- 业务场景存在跨measurement join的情况，比如提现与提现结果通知，如果需要统计当天内建议放款的提现请求中当天即放款(成功)的申请数或者人数，

则需要进行join on seq_num then count(uid) or count(seq_num)

好消息是influx 1.7+版本的flux查询语言已经支持Join。- 满足

- influxdb单机版存在的问题，存储限制以及单点故障，存储限制可以通知CQ(连续查询)与RP(保留政策)功能进行数据精读的降低，从而减少存储空间的占用

由于目前存在单点，故不允许业务直连influxdb进行写入，都必须通过agent telegraf进行数据采集（推/拉）。 - 满足

- 多个Input plugin 写入不同的数据库，详见官网中telegraf的配置方法 - 满足


- 外部服务质量监控目前采用全采样，后续降低采样率的方法？

- 使用influx数据库做监控与普通的zabbix+shell脚本统计的差别在于，事件数据基于时序存储，存储压缩以及查询性能更好，可以对数据执行不同粒度的window aggration, 甚至做相邻窗口间指标的同比变化趋势监控，且统一化的UI更贴合业务的需要。

- 监控指标需要可视化，最好可以定制业务的dashboard，方便业务方能够管理与检索指标的历史变化情况。同时支持业务方定制报警阈值。-满足

